/**
 * ngPullToRefresh - CSS3 pull-to-refresh directive for AngularJS
 * @version v0.2.2 - 2013-06-21
 * @link 
 * @author 
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("mgcrea.pullToRefresh",[]).constant("pullToRefreshConfig",{treshold:40,debounce:400,messages:{pull:"pull to refresh",release:"release to refresh",loading:"refreshing..."}}).directive("pullToRefresh",["$compile","$timeout","$q","pullToRefreshConfig",function(a,b,c,d){var e="<div class=\"ptr\" ng-class=\"'ptr-'+status\"><i class=\"icon-refresh\" ng-class=\"{'icon-arrow-down':status==='pull', 'icon-arrow-up':status==='release', 'icon-refresh icon-spin':status==='loading'}\"></i>&nbsp;<span class=\"ptr-message\">{{messages[status]}}</span></div>";return{restrict:"A",scope:!0,compile:function(f){f.prepend(e);var g=f.find(".pull-to-refresh");return function(e,f,h){var i=angular.extend({},d,h);e.$loading=!1,e.messages=i.messages,e.status="pull",b(function(){a(g)(e)});var j=!1;f.bind("touchmove",function(){var a=f[0].scrollTop;a<-i.treshold&&!j?(j=!0,e.$apply(function(){e.status="release"})):a>-i.treshold&&j&&(j=!1,e.$apply(function(){e.status="pull"}))}),f.bind("touchend",function(){j&&(j=!1,e.$apply(function(){e.$loading=!0,e.status="loading";var a=+new Date;c.when(e.$eval(h.pullToRefresh)).then(function(){var c=+new Date-a;b(function(){e.$loading=!1,e.status="pull"},c<i.debounce?i.debounce-c:0)})}))}),e.$on("$destroy",function(){f.unbind("touchstart"),f.unbind("touchmove"),f.unbind("touchend")})}}}}]);